# 142. 环形链表 II
万物皆可哈希表，但是这样内存消耗比较大。我一开始觉得快慢指针法无法解决这个问题，但是还是被世界上最优秀的大脑给秀到了。

## 快慢指针
利用了一些几何的技巧。

![](1.png)

如果连表存在环，那么快慢指针一定会在环上的某一点相遇（如图中紫色的节点）。我们不妨假设环外的长度是 a，入环的第一个节点与相交点的距离是 b，剩下一段的长度是 c。

**在慢指针走完第一圈的时候就会和快指针相遇**

这个很好理解，因为慢指针走一圈，快指针可以走两圈，慢指针在走完第一圈之前一定被套圈了。

在这个基础上我们数一数快慢指针走的路程的数学表达式（基于 a b c 的表达式）。

慢指针： a + b

快指针： 2(a + b)

我们不妨假设快慢指针相遇时，**快指针在环中绕了 n 圈**。

那么快指针路程还可以表示为： a + n(b + c)

无论如何表达，快指针的路程是一样的，所以有： 2(a + b) = a + n(b + c)

化简得： a = c + (n-1)(b + c)

这个表达式将 a 用 b c n 表示了出来。但由于这三个都是未知量，所以好像还是求不出来。

但也不是完全没有信息，因为我们知道慢指针走完一圈之前就和快指针相遇了，基于此，从头节点遍历到相遇的节点，我们知道了 a + b 是多少。

trick 就在这里：让一个指针 p1 从 a 出发，另一个指针 p2 从快慢指针交界处出发。当他们相遇的时候，p1 走了 d1，p2 走了 d2。

这里有一个强假设，p1 会和 p2 相遇。真的是这样🏇？

先从临界点出发，考虑 p1 刚刚走上环的情况。此时 p1 走了 a 这么长，p2 也走了 a 这么长，但 p2 在入环点前面还是后面呢？

我们似乎有一个等式 a = c + (n-1)(b + c)

？？？p2 一定走了 n 圈加 c 的长度，也就是说，就在入环点上！！

他们相遇的点就是入环点，done。
